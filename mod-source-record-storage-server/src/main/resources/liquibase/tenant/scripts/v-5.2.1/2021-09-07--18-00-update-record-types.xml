<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

  <changeSet id="2021-09-07--18-00-rename-marc-type-to-marc-bib" author="SerhiiZdorenko" runInTransaction="false">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="1">
        SELECT COUNT(*)
        FROM pg_type t
        JOIN pg_enum e ON t.oid = e.enumtypid
        JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
        WHERE e.enumlabel='MARC' AND t.typname = 'record_type' AND n.nspname = '${database.defaultSchemaName}';
      </sqlCheck>
    </preConditions>
    <sql>
      ALTER TYPE ${database.defaultSchemaName}.record_type RENAME VALUE 'MARC' TO 'MARC_BIB';
    </sql>
  </changeSet>
</databaseChangeLog>
